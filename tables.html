<style>
	table, th, td {
		border: 1px solid black;
		border-collapse: collapse;
	}
</style>

<html>
	<div>
		<h5>Simple Table</h5>
		<button onclick="exportAsExcel('example1')" >Export </button>
		<table id="example1">
			<thead>
				<tr>
					<th>Category</th>
					<th>Male</th>
					<th>Female</th>
					<th>Others</th>
					<th>Total</th>
				</tr>
			</thead>

			<tbody>
				<tr>
					<th>GENERAL</th>
					<td>269</td>
					<td>53</td>
					<td>0</td>
					<td>322</td>
				</tr>
				<tr>
					<th>GENERAL-EWS</th>
					<td>14</td>
					<td>1</td>
					<td>0</td>
					<td>15</td>
				</tr>
				<tr>
					<th>OBC</th>
					<td>71</td>
					<td>6</td>
					<td>0</td>
					<td>77</td>
				</tr>
				<tr>
					<th>SC</th>
					<td>69</td>
					<td>4</td>
					<td>0</td>
					<td>73</td>
				</tr>
				<tr>
					<th>ST</th>
					<td>1</td>
					<td>0</td>
					<td>0</td>
					<td>1</td>
				</tr>
			</tbody>

			<thead>
				<tr>
				<th>Total</th>
					<th>424</th>
					<th>64</th>
					<th>0</th>
					<th>488</th>
				</tr>
			</thead>
		</table>
	</div>
	<hr>
	
	<div>
		<h5>Table with Rowspan</h5>
		<button onclick="exportAsExcel('example2')" >Export </button>
		<table id="example2">
			<thead>
				<tr>
					<th>Programme</th>
					<th>Category</th>
					<th>Male</th>
					<th>Female</th>
					<th>Others</th>
					<th>Total</th>
				</tr>
			</thead>
			
			<tbody>
				<tr>
					<th rowspan="4" style="background: #DCDCDC; border-bottom:1px solid black">
					MSc in Big Data Analytics                            		</th>
					<th style="border-bottom: 1px solid black">GENERAL</th>
					<td style="border-bottom: 1px solid black">48</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">48</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">GENERAL-EWS</th>
					<td style="border-bottom: 1px solid black">4</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">4</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">OBC</th>
					<td style="border-bottom: 1px solid black">5</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">5</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">SC</th>
					<td style="border-bottom: 1px solid black">2</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">2</td>
				</tr>

				<tr>
					<th rowspan="4" style="background: #DCDCDC; border-bottom:1px solid black">
					MSc in Computer Science                            		</th>
					<th style="border-bottom: 1px solid black">GENERAL</th>
					<td style="border-bottom: 1px solid black">30</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">30</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">GENERAL-EWS</th>
					<td style="border-bottom: 1px solid black">1</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">1</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">OBC</th>
					<td style="border-bottom: 1px solid black">3</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">3</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">SC</th>
					<td style="border-bottom: 1px solid black">1</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">1</td>
				</tr>

				<tr>
					<th rowspan="4" style="background: #DCDCDC; border-bottom:1px solid black">
					MSc in Mathematics                            		</th>
					<th style="border-bottom: 1px solid black">GENERAL</th>
					<td style="border-bottom: 1px solid black">34</td>
					<td style="border-bottom: 1px solid black">17</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">51</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">GENERAL-EWS</th>
					<td style="border-bottom: 1px solid black">7</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">7</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">OBC</th>
					<td style="border-bottom: 1px solid black">7</td>
					<td style="border-bottom: 1px solid black">4</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">11</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">SC</th>
					<td style="border-bottom: 1px solid black">4</td>
					<td style="border-bottom: 1px solid black">1</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">5</td>
				</tr>

				<tr>
					<th rowspan="3" style="background: #DCDCDC; border-bottom:1px solid black">
					Integrated 5 Year MA in Sanskrit(M)                            		</th>
					<th style="border-bottom: 1px solid black">GENERAL</th>
					<td style="border-bottom: 1px solid black">47</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">47</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">OBC</th>
					<td style="border-bottom: 1px solid black">20</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">20</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">SC</th>
					<td style="border-bottom: 1px solid black">23</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">23</td>
				</tr>

				<tr>
					<th rowspan="4" style="background: #DCDCDC; border-bottom:1px solid black">
					MSc in Physics                            		</th>
					<th style="border-bottom: 1px solid black">GENERAL</th>
					<td style="border-bottom: 1px solid black">49</td>
					<td style="border-bottom: 1px solid black">23</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">72</td>
				</tr>
				<tr>
					<th style="border-bottom: 1px solid black">GENERAL-EWS</th>
					<td style="border-bottom: 1px solid black">1</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">1</td>
					</tr>
				<tr>
					<th style="border-bottom: 1px solid black">OBC</th>
					<td style="border-bottom: 1px solid black">9</td>
					<td style="border-bottom: 1px solid black">2</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">11</td>
					</tr>
				<tr>
					<th style="border-bottom: 1px solid black">SC</th>
					<td style="border-bottom: 1px solid black">4</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">0</td>
					<td style="border-bottom: 1px solid black">4</td>
				</tr>
			</tbody>
		
			<thead>
				<tr>
					<th colspan="2" style="text-align:center;">Total</th>
					<th>424</th>
					<th>64</th>
					<th>0</th>
					<th>488</th>
				</tr>
			</thead>
		</table>
	</div>     

	<hr>
	          
	<div>
		<h5>Table with Colspan & Rowspan</h5>
		<button onclick="exportAsExcel('example3')" >Export </button>
		<table id="example3">
			<thead>
				<tr>
					<th rowspan="3">Example</th>
					<th colspan="7">Larger Header</th>
					</tr>
					<tr class="table_headers">
					<th colspan="3">Sub Header 1</th>
					<th colspan="3">Sub Header 2</th>
					<th rowspan="2" class="align-middle">Sub Header 3</th>
				</tr>
				<tr class="table_headers">
					<th>Sub sub header</th>
					<th>Sub sub header</th>
					<th>Sub sub header</th>
					<th>Sub sub header</th>
					<th>Sub sub header</th>
					<th>Sub sub header</th>
				</tr>
			</thead>

			<tbody>
				<tr>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
					<td> Info</td>
				</tr>
			</tbody>
		</table>
	</div>         
<html>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script>
function generateExcel(el) {
	var clon = el.clone();
	var html = clon.wrap('<div>').parent().html();

	html = html.replace(/<td>/g, "<td>&nbsp;");

	var blob = new Blob(['\ufeff', html], {
		type: 'application/vnd.ms-excel'
	});

	// Specify link url
	var url = 'data:application/vnd.ms-excel;charset=utf-8,' + encodeURIComponent(html);

	// Specify file name
	datetime = new Date().toISOString().substr(0, 10);
	filename = "Report-"+datetime+".xlsx";

	// Create download link element
	var downloadLink = document.createElement("a");

	document.body.appendChild(downloadLink);

	if(navigator.msSaveOrOpenBlob ){
	navigator.msSaveOrOpenBlob(blob, filename);
	}else{
	// Create a link to the file
	downloadLink.href = url;

	// Setting the file name
	downloadLink.download = filename;

	//triggering the function
	downloadLink.click();
	}

	document.body.removeChild(downloadLink);
}

function exportAsExcel(tid) {
	generateExcel($("#"+tid));
}
</script>

